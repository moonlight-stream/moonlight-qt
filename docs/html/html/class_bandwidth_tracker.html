<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>moonlight-qt: BandwidthTracker Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">moonlight-qt
   </div>
   <div id="projectbrief">PC client for NVIDIA GameStream and Sunshine</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="class_bandwidth_tracker-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">BandwidthTracker Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>The <a class="el" href="class_bandwidth_tracker.html" title="The BandwidthTracker class tracks network bandwidth usage over a sliding time window (default 10s).">BandwidthTracker</a> class tracks network bandwidth usage over a sliding time window (default 10s).  
 <a href="class_bandwidth_tracker.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="bandwidth_8h_source.html">bandwidth.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ae9d78d79acf86b0a167e9a26bad88863" id="r_ae9d78d79acf86b0a167e9a26bad88863"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bandwidth_tracker.html#ae9d78d79acf86b0a167e9a26bad88863">BandwidthTracker</a> (std::uint32_t windowSeconds=10, std::uint32_t bucketIntervalMs=250)</td></tr>
<tr class="memdesc:ae9d78d79acf86b0a167e9a26bad88863"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs a new <a class="el" href="class_bandwidth_tracker.html" title="The BandwidthTracker class tracks network bandwidth usage over a sliding time window (default 10s).">BandwidthTracker</a> object.  <br /></td></tr>
<tr class="separator:ae9d78d79acf86b0a167e9a26bad88863"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f7cceac8b1ba04913cf374d42784f05" id="r_a4f7cceac8b1ba04913cf374d42784f05"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bandwidth_tracker.html#a4f7cceac8b1ba04913cf374d42784f05">AddBytes</a> (size_t bytes)</td></tr>
<tr class="memdesc:a4f7cceac8b1ba04913cf374d42784f05"><td class="mdescLeft">&#160;</td><td class="mdescRight">Record bytes that were received or sent.  <br /></td></tr>
<tr class="separator:a4f7cceac8b1ba04913cf374d42784f05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fd48165ccaef554d1ef3617494d960b" id="r_a5fd48165ccaef554d1ef3617494d960b"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bandwidth_tracker.html#a5fd48165ccaef554d1ef3617494d960b">GetAverageMbps</a> ()</td></tr>
<tr class="memdesc:a5fd48165ccaef554d1ef3617494d960b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes and returns the average bandwidth in Mbps for the most recent 25% of buckets.  <br /></td></tr>
<tr class="separator:a5fd48165ccaef554d1ef3617494d960b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b13e0faf771003ed52a72bc69fe28dd" id="r_a6b13e0faf771003ed52a72bc69fe28dd"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bandwidth_tracker.html#a6b13e0faf771003ed52a72bc69fe28dd">GetPeakMbps</a> ()</td></tr>
<tr class="memdesc:a6b13e0faf771003ed52a72bc69fe28dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the peak bandwidth in Mbps observed in any single bucket within the current window.  <br /></td></tr>
<tr class="separator:a6b13e0faf771003ed52a72bc69fe28dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a540665f2d19793718d6312201f3c31" id="r_a4a540665f2d19793718d6312201f3c31"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bandwidth_tracker.html#a4a540665f2d19793718d6312201f3c31">GetCurrentMbps</a> ()</td></tr>
<tr class="memdesc:a4a540665f2d19793718d6312201f3c31"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the bandwidth in Mbps of the most recently completed bucket.  <br /></td></tr>
<tr class="separator:a4a540665f2d19793718d6312201f3c31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2dd263125e2e7f354faf485de6b91386" id="r_a2dd263125e2e7f354faf485de6b91386"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bandwidth_tracker.html#a2dd263125e2e7f354faf485de6b91386">GetWindowSeconds</a> ()</td></tr>
<tr class="memdesc:a2dd263125e2e7f354faf485de6b91386"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieves the duration of the tracking window.  <br /></td></tr>
<tr class="separator:a2dd263125e2e7f354faf485de6b91386"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The <a class="el" href="class_bandwidth_tracker.html" title="The BandwidthTracker class tracks network bandwidth usage over a sliding time window (default 10s).">BandwidthTracker</a> class tracks network bandwidth usage over a sliding time window (default 10s). </p>
<p>Byte totals are grouped into fixed time interval buckets (default 250ms). This provides an element of smoothing and deals well with spikes.</p>
<p><a class="el" href="class_bandwidth_tracker.html#a5fd48165ccaef554d1ef3617494d960b" title="Computes and returns the average bandwidth in Mbps for the most recent 25% of buckets.">GetAverageMbps()</a> is calculated using the 25% most recent fully completed buckets. The default settings will return an average of the past 2.5s of data, ignoring the in-progress bucket. Using only 2.5s of data for the average provides a good balance of reactivity and smoothness.</p>
<p><a class="el" href="class_bandwidth_tracker.html#a6b13e0faf771003ed52a72bc69fe28dd" title="Returns the peak bandwidth in Mbps observed in any single bucket within the current window.">GetPeakMbps()</a> returns the peak bandwidth seen during any one bucket interval across the full time window.</p>
<p>All public methods are thread safe. A typical use case is calling <a class="el" href="class_bandwidth_tracker.html#a4f7cceac8b1ba04913cf374d42784f05" title="Record bytes that were received or sent.">AddBytes()</a> in a data processing thread while calling <a class="el" href="class_bandwidth_tracker.html#a5fd48165ccaef554d1ef3617494d960b" title="Computes and returns the average bandwidth in Mbps for the most recent 25% of buckets.">GetAverageMbps()</a> from a UI thread.</p>
<p>Example usage: </p><div class="fragment"><div class="line"><a class="code hl_class" href="class_bandwidth_tracker.html">BandwidthTracker</a> bwTracker(10, 250); <span class="comment">// 10-second window, 250ms buckets</span></div>
<div class="line">bwTracker.AddBytes(64000);</div>
<div class="line">bwTracker.AddBytes(128000);</div>
<div class="line"><span class="keywordtype">double</span> avg = bwTracker.GetAverageMbps();</div>
<div class="line"><span class="keywordtype">double</span> peak = bwTracker.GetPeakMbps();</div>
<div class="ttc" id="aclass_bandwidth_tracker_html"><div class="ttname"><a href="class_bandwidth_tracker.html">BandwidthTracker</a></div><div class="ttdoc">The BandwidthTracker class tracks network bandwidth usage over a sliding time window (default 10s).</div><div class="ttdef"><b>Definition</b> <a href="bandwidth_8h_source.html#l00032">bandwidth.h:33</a></div></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="bandwidth_8h_source.html#l00032">32</a> of file <a class="el" href="bandwidth_8h_source.html">bandwidth.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ae9d78d79acf86b0a167e9a26bad88863" name="ae9d78d79acf86b0a167e9a26bad88863"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9d78d79acf86b0a167e9a26bad88863">&#9670;&#160;</a></span>BandwidthTracker()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BandwidthTracker::BandwidthTracker </td>
          <td>(</td>
          <td class="paramtype">std::uint32_t&#160;</td>
          <td class="paramname"><em>windowSeconds</em> = <code>10</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::uint32_t&#160;</td>
          <td class="paramname"><em>bucketIntervalMs</em> = <code>250</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructs a new <a class="el" href="class_bandwidth_tracker.html" title="The BandwidthTracker class tracks network bandwidth usage over a sliding time window (default 10s).">BandwidthTracker</a> object. </p>
<p>Initializes the tracker to maintain statistics over a sliding window of time. The window is divided into buckets of fixed duration (bucketIntervalMs).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">windowSeconds</td><td>The duration of the tracking window in seconds. Default is 10 seconds. </td></tr>
    <tr><td class="paramname">bucketIntervalMs</td><td>The interval for each bucket in milliseconds. Default is 250 ms. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="bandwidth_8cpp_source.html#l00005">5</a> of file <a class="el" href="bandwidth_8cpp_source.html">bandwidth.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a4f7cceac8b1ba04913cf374d42784f05" name="a4f7cceac8b1ba04913cf374d42784f05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f7cceac8b1ba04913cf374d42784f05">&#9670;&#160;</a></span>AddBytes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BandwidthTracker::AddBytes </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>bytes</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Record bytes that were received or sent. </p>
<p>This method updates the corresponding bucket for the current time interval with the new data. It is thread-safe. Bytes are associated with the bucket for "now" and it is not possible to submit data for old buckets. This function should be called as needed at the time the bytes were received. Callers should not maintain their own byte totals.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">bytes</td><td>The number of bytes to add. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="bandwidth_8cpp_source.html#l00017">17</a> of file <a class="el" href="bandwidth_8cpp_source.html">bandwidth.cpp</a>.</p>

</div>
</div>
<a id="a5fd48165ccaef554d1ef3617494d960b" name="a5fd48165ccaef554d1ef3617494d960b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5fd48165ccaef554d1ef3617494d960b">&#9670;&#160;</a></span>GetAverageMbps()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double BandwidthTracker::GetAverageMbps </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes and returns the average bandwidth in Mbps for the most recent 25% of buckets. </p>
<dl class="section return"><dt>Returns</dt><dd>The average bandwidth in megabits per second. </dd></dl>

<p class="definition">Definition at line <a class="el" href="bandwidth_8cpp_source.html#l00025">25</a> of file <a class="el" href="bandwidth_8cpp_source.html">bandwidth.cpp</a>.</p>

</div>
</div>
<a id="a4a540665f2d19793718d6312201f3c31" name="a4a540665f2d19793718d6312201f3c31"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a540665f2d19793718d6312201f3c31">&#9670;&#160;</a></span>GetCurrentMbps()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double BandwidthTracker::GetCurrentMbps </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the bandwidth in Mbps of the most recently completed bucket. </p>
<p>This provides a "current" bitrate value that represents the most recent completed time interval, which is more recent than the average but more stable than an in-progress bucket.</p>
<dl class="section return"><dt>Returns</dt><dd>The bandwidth in megabits per second of the most recently completed bucket, or 0.0 if no valid completed bucket exists. </dd></dl>

<p class="definition">Definition at line <a class="el" href="bandwidth_8cpp_source.html#l00069">69</a> of file <a class="el" href="bandwidth_8cpp_source.html">bandwidth.cpp</a>.</p>

</div>
</div>
<a id="a6b13e0faf771003ed52a72bc69fe28dd" name="a6b13e0faf771003ed52a72bc69fe28dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b13e0faf771003ed52a72bc69fe28dd">&#9670;&#160;</a></span>GetPeakMbps()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double BandwidthTracker::GetPeakMbps </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the peak bandwidth in Mbps observed in any single bucket within the current window. </p>
<p>This value represents the highest instantaneous throughput measured over one bucket interval.</p>
<dl class="section return"><dt>Returns</dt><dd>The peak bandwidth in megabits per second. </dd></dl>

<p class="definition">Definition at line <a class="el" href="bandwidth_8cpp_source.html#l00054">54</a> of file <a class="el" href="bandwidth_8cpp_source.html">bandwidth.cpp</a>.</p>

</div>
</div>
<a id="a2dd263125e2e7f354faf485de6b91386" name="a2dd263125e2e7f354faf485de6b91386"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2dd263125e2e7f354faf485de6b91386">&#9670;&#160;</a></span>GetWindowSeconds()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int BandwidthTracker::GetWindowSeconds </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieves the duration of the tracking window. </p>
<p>This is useful when displaying the length of the peak, e.g. </p><div class="fragment"><div class="line">printf(<span class="stringliteral">&quot;Bitrate: %.1f Mbps Peak (%us): %.1f\n&quot;</span>,</div>
<div class="line">       bw.getAverageMbps(), bw.GetWindowSeconds(), bw.getPeakMbps());</div>
</div><!-- fragment --><dl class="section return"><dt>Returns</dt><dd>The window duration in seconds. </dd></dl>

<p class="definition">Definition at line <a class="el" href="bandwidth_8cpp_source.html#l00088">88</a> of file <a class="el" href="bandwidth_8cpp_source.html">bandwidth.cpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/runner/work/moonlight-qt/moonlight-qt/app/streaming/<a class="el" href="bandwidth_8h_source.html">bandwidth.h</a></li>
<li>/home/runner/work/moonlight-qt/moonlight-qt/app/streaming/<a class="el" href="bandwidth_8cpp_source.html">bandwidth.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Nov 28 2025 23:20:43 for moonlight-qt by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
